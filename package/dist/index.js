var X=Object.create;var I=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ne=(e,t)=>{for(var i in t)I(e,i,{get:t[i],enumerable:!0})},U=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ee(t))!re.call(e,r)&&r!==i&&I(e,r,{get:()=>t[r],enumerable:!(s=Z(t,r))||s.enumerable});return e};var ie=(e,t,i)=>(i=e!=null?X(te(e)):{},U(t||!e||!e.__esModule?I(i,"default",{value:e,enumerable:!0}):i,e)),se=e=>U(I({},"__esModule",{value:!0}),e);var Re={};ne(Re,{MatchedAnimationRule:()=>R,ParseCSS:()=>Me,cssParser:()=>D,resetData:()=>$});module.exports=se(Re);function B(e,t={}){return e.type==="decl"&&(t[e.prop]=e.value),t}function w(e,t={},i=!0){if(e.type==="rule"){let s={};for(let r of e.nodes)r.type==="decl"?s=B(r,s):r.type==="rule"?s=w(r,s):r.type==="atrule"&&(s=P(r,s));if(i)t[e.selector]=s;else return s;return t}}function P(e,t={}){var i;if(e.type==="atrule"){let s={};if((i=e.nodes)!=null&&i[Symbol.iterator])for(let r of e.nodes)r.type==="decl"?s=B(r,s):r.type==="rule"?s=w(r,s):r.type==="atrule"&&(s=P(r,s));return t[`@${e.name} ${e.params}`]=s,t}}var ae=new Set(["normal","reverse","alternate","alternate-reverse"]),oe=new Set(["running","paused"]),le=new Set(["none","forwards","backwards","both"]),fe=new Set(["infinite"]),ue=new Set(["linear","ease","ease-in","ease-out","ease-in-out","step-start","step-end"]),me=["cubic-bezier","steps"],de=/\,(?![^(]*\))/g,pe=/\ +(?![^(]*\))/g,E=/^(-?[\d.]+m?s)$/,ce=/^(\d+)$/;function v(e){return e.split(de).map(i=>{var a;let s=i.trim(),r={value:s},l=s.split(pe),o=new Set;for(let n of l)!o.has("DIRECTIONS")&&ae.has(n)?(r.direction=n,o.add("DIRECTIONS")):!o.has("PLAY_STATES")&&oe.has(n)?(r.playState=n,o.add("PLAY_STATES")):!o.has("FILL_MODES")&&le.has(n)?(r.fillMode=n,o.add("FILL_MODES")):!o.has("ITERATION_COUNTS")&&(fe.has(n)||ce.test(n))?(r.iterationCount=n,o.add("ITERATION_COUNTS")):!o.has("TIMING_FUNCTION")&&ue.has(n)||!o.has("TIMING_FUNCTION")&&me.some(f=>n.startsWith(`${f}(`))?(r.timingFunction=n,o.add("TIMING_FUNCTION")):!o.has("DURATION")&&E.test(n)?(r.duration=n,o.add("DURATION")):!o.has("DELAY")&&E.test(n)?(r.delay=n,o.add("DELAY")):o.has("NAME")?((a=r.unknown)!=null||(r.unknown=[]),r.unknown.push(n)):(r.name=n,o.add("NAME"));return r})}var x=new Map,S=new Map;function J(){x.clear(),S.clear()}function _(e,t,i){if(e.name="keyframes"){if(e.parent.type=="rule")return!1;let s=m(e);return x.set(s,e),!0}return!1}function j(e,t,i,s,r){var l;for(let[o,a]of S.entries()){let n=a.rule;t.delete(o),i.delete(o);let f=w(n,{},!1),d=r.animationPrefix,p=new R({node:n,stringifiedNode:f},d);for(let g of a.keyframes){let h=x.get(g);if(h==null){let K=(l=s.get(g))!=null?l:new Set;K.has(n.selector)||K.add(n.selector);continue}let H=P(h);p.content.push({node:h,stringifiedNode:H})}e.set(o,p)}}function z(e,t){var i,s;if(e.prop=="animation"){let r=m(t),l=v(e.value),o=!1;for(let a of l){let n=a.name;if(n==null)continue;let f=(i=S.get(r))!=null?i:{rule:t,keyframes:new Set};f.keyframes.has(n)||f.keyframes.add(`@keyframes ${n}`),S.set(r,f),o=!0}return o}else if(e.prop=="animation-name"){let r=m(t),l=(s=S.get(r))!=null?s:{rule:t,keyframes:new Set};return l.keyframes.has(e.value)||l.keyframes.add(`@keyframes ${e.value}`),S.set(r,l),!0}return!1}function m(e){let t="";return e.type=="rule"?(e=e,t=e.selector):e.type=="atrule"&&(e=e,t=`@${e.name} ${e.params}`),t}function N(e,t,i,s,r=1){if(e.nodes==null||e.nodes.length==0)return;let l="",o="";for(let n=0;n<r;n++)l+="	",n<r-1&&(o+="	");let a=t.openBracketNewLine?`
${o}`:" ";if(e.type==="rule"){let n=e,f=n.selectors.join(`,
${o}`);n.selector=f,n.raws.between=a}else if(e.type=="atrule"){let n=e;n.params=n.params.trim(),n.raws.afterName=" ",n.raws.between=a}for(let n of e.nodes)n.type=="decl"&&s.type=="rule"&&z(n,s),n.raws.before=`
`+l,n.raws.after=`
`+l,N(n,t,i,s,r+1);r==1&&(e.raws.before=`
`,t.commentType!=="None"&&(e.raws.before+=`/* From ${i.opts.from} */
`),e.raws.after=`
`)}var R=class{constructor(t,i){this.content=[];this.rule=t,this.intellisensePrefix=i}getMatchedContent(){let t={},i=this.content.map(r=>r.stringifiedNode),s=Object.fromEntries(i.entries());return t[this.intellisensePrefix]=r=>[s,this.rule.stringifiedNode],t}getMatchedValues(){let t={},i=m(this.rule.node).match(/\w+/g).join("-");return t[i]="",{values:t}}};var k=require("fs"),F=require("path"),Q=ie(require("postcss"));var L="[layer-parser]:";function A(e=1){let t=`
`;for(let i=0;i<e;i++)t+="	";return t+="- ",t}function T(e){console.log(`${L} ${e}`)}function u(e){console.warn(`${L} ${e}`)}function Y(e){console.error(`${L} ${e}`)}var q=require("glob");var c=new Map,y=new Map,O=new Map,C=new Map,M=new Map,b=new Map;function W(e,t){let i=m(e);if(y.has(i)||c.has(i)){let s=C.get(i);if(s){let r=s==null?void 0:s.get(t.opts.from);r?s.set(t.opts.from,r+1):s.set(t.opts.from,1)}else C.set(i,new Map([[t.opts.from,1]]));return!1}return!0}function ye(e,t,i){var r,l,o;let s=m(e);if(((r=e.parent)==null?void 0:r.type)==="root"){if(W(e,t)){if(i.unlayeredClassBehavior==="Ignore"){let a=(l=M.get(s))!=null?l:new Set;a.add(t.opts.from),M.set(s,a);return}N(e,i,t,e),i.unlayeredClassBehavior==="Utility"?y.set(s,e):i.unlayeredClassBehavior==="Component"&&c.set(s,e)}}else if(((o=e.parent)==null?void 0:o.type)=="atrule"&&W(e,t)){let a=e.parent;a.params==="components"?(N(e,i,t,e),c.set(s,e)):a.params==="utilities"&&(N(e,i,t,e),y.set(s,e))}}function ge(e,t,i){_(e,t,i)}function he(e){return()=>({Rule(t,{result:i}){ye(t,i,e)},AtRule:{keyframes:(t,{result:i})=>{ge(t,i,e)}}})}function Se(e){var i,s,r,l,o;let t=a=>a!==!0&&a!==!1;e.directory==null&&(u("There was no directory provided. Defaulting to process.cwd()."),e.directory=process.cwd()),(i=e.commentType)!=null||(e.commentType="File"),e.commentType!=="File"&&e.commentType!="Absolute"&&e.commentType!="None"&&(u("Invalid configuration for commentType. Defaulting to 'File'"),e.commentType="File"),(s=e.openBracketNewLine)!=null||(e.openBracketNewLine=!1),t(e.openBracketNewLine)&&(u("Invalid configuration for openBracketNewLine. Defaulting to false"),e.openBracketNewLine=!1),(r=e.debug)!=null||(e.debug=!1),t(e.debug)&&(u("Invalid configuration for debug. Defaulting to false."),e.debug=!1),(l=e.unlayeredClassBehavior)!=null||(e.unlayeredClassBehavior="Utility"),e.unlayeredClassBehavior!=="Utility"&&e.unlayeredClassBehavior!=="Component"&&e.unlayeredClassBehavior!=="Ignore"&&(u("Invalid configuration for unlayedClassBehavior. Defaulting to Utility"),e.unlayeredClassBehavior="Utility"),(o=e.globPatterns)!=null||(e.globPatterns=["**/*.css"]),(e.animationPrefix==null||e.animationPrefix.trim().length==0)&&(e.animationPrefix="animate")}function $(){c.size==0&&y.size==0&&T("Reset parsed components and utilities."),c.clear(),y.clear(),O.clear(),J()}function D(e){if(e.globPatterns!=null&&e.globPatterns.length>0){for(let a of e.globPatterns)if(a.startsWith("/**"))return Y(`User attempted to glob their entire computer using: ${a}. This would result in a serious performance problem, and thus parsing has been skipped.`),{components:[],utilities:[],keyframeUtilities:[]}}Se(e),C.clear(),M.clear(),b.clear();let t=(0,F.resolve)(e.directory),i=[];i=(0,q.globSync)(e.globPatterns,{cwd:t}),e.debug&&(T(`Searched directories: ${t}`),T(`Found: ${i.join("	")}`));let s={postcssPlugin:"layer-parser",prepare:he(e)},r=[],l=(0,Q.default)([s]),o;switch(e.commentType){case"Absolute":o=(a,n)=>{let f=(0,k.readFileSync)(n,"utf8");l.process(f,{from:n,to:n}).then(d=>{})};break;default:o=(a,n)=>{let f=(0,k.readFileSync)(n,"utf8");l.process(f,{from:a,to:a}).then(d=>{})};break}for(let a of i){if(!a.endsWith(".css")){r.push(a);continue}let n=(0,F.resolve)(t,a);o(a,n)}if(r.length>0&&u(`Globbing resulted in files that did not end in .css:
	${r.join(A())}`),M.size>0){let a=`The target directory: ${e.directory} had ${M.size} unlayered css rules not parsed:`;if(e.debug)for(let[n,f]of M)a+=`
	${n}`,a+=`
		- `,a+=Array.from(f.values()).join(A(2));u(a)}if(C.size>0){let a="",n=0;for(let[d,p]of C){a+=`
	${d}`;for(let[g,h]of p)a+=`${A(2)}${g} - ${h}`,n+=h}let f=`Found ${n} rules with selectors that were already used. Note, this only discovers root-level (not nested) duplicates that would be added based on the configuration.`;e.debug&&(f+=a),u(f)}if(j(O,c,y,b,e),b.size>0){let a="",n=0;for(let[d,p]of b){a+=`
	${d}`,n+=p.size;for(let g of p)a+=`${A(2)}${g}`}let f=`Could not find ${n} keyframes that were referenced by the searched CSS files.`;e.debug&&(f+=a),u(f)}return{utilities:Array.from(y.values()),components:Array.from(c.values()),keyframeUtilities:Array.from(O.values())}}function Me(e){return({addUtilities:t,addComponents:i,matchUtilities:s})=>{$();let r=D(e);for(let l of r.utilities)t(l);for(let l of r.components)i(l);for(let l of r.keyframeUtilities)s(l.getMatchedContent(),l.getMatchedValues())}}0&&(module.exports={MatchedAnimationRule,ParseCSS,cssParser,resetData});
